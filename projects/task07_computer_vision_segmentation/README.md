# Эксперимент A: Обучение UNet

## Описание эксперимента
В этом эксперименте мы обучали модель UNet. Целью было понять, как модель будет работать на ограниченном наборе данных и сможет ли она достичь приемлемого качества сегментации.

## Архитектура модели
Мы использовали базовую архитектуру UNet со следующими характеристиками:
- Входные каналы: 3 (RGB изображения)
- Начальные выходные каналы: 64
- Конечные выходные каналы: 1 (бинарная маска)
- Четыре шага понижения и повышения разрешения

## Процесс обучения
- Функция потерь: Dice Loss
- Оптимизатор: Adam с learning rate 1e-4
- Размер пакета: 4
- Количество эпох: 20
- Аугментация данных: отсутствует

## Результаты
Производительность модели оценивалась с помощью метрики IoU (Intersection over Union) на тестовом наборе данных. Ниже приведены результаты по эпохам:

| Эпоха | Потери на обучении | IoU на тесте |
|-------|--------------------|--------------|
| 1     | 3.3669             | 0.1572       |
| 2     | 5.6425             | 0.1572       |
| 3     | 1.2259             | 0.1572       |
| 4     | 3.6452             | 0.1572       |
| 5     | 2.6132             | 0.1136       |
| 6     | 3.7147             | 0.0712       |
| 7     | 1.8407             | 0.1085       |
| 8     | 1.6920             | 0.1532       |
| 9     | 1.5801             | 0.1991       |
| 10    | 1.5605             | 0.2140       |
| 11    | 1.5155             | 0.2021       |
| 12    | 1.6225             | 0.1871       |
| 13    | 1.5742             | 0.2007       |
| 14    | 1.4481             | 0.2029       |
| 15    | 1.5323             | 0.2134       |
| 16    | 1.6312             | 0.2175       |
| 17    | 1.4252             | 0.2184       |
| 18    | 1.4053             | 0.2168       |
| 19    | 1.4272             | 0.2098       |
| 20    | 1.3772             | 0.2286       |

Итоговый показатель IoU на тестовом наборе данных составил 0.2286.

## Вывод
Модель UNet показала устойчивое улучшение производительности по метрике IoU в течение первых 10 эпох, после чего улучшения стали менее значительными. Лучший результат IoU составил 0.2286, что указывает на ограниченную способность модели к обобщению на тестовых данных при отсутствии аугментации.

# Эксперимент B: Обучение UNet с аугментацией данных

## Описание эксперимента
В этом эксперименте мы добавили методы аугментации данных, чтобы улучшить производительность модели UNet. Использовалась та же архитектура модели.

## Архитектура модели
- Входные каналы: 3 (RGB изображения)
- Начальные выходные каналы: 64
- Конечные выходные каналы: 1 (бинарная маска)
- Четыре шага понижения и повышения разрешения

## Процесс обучения
- Функция потерь: Dice Loss
- Оптимизатор: Adam с learning rate 1e-4
- Размер пакета: 8
- Количество эпох: 20

### Аугментация данных
- Изменение размера до 256x256
- Случайное кадрирование до 224x224
- Горизонтальное отражение с вероятностью 0.5
- Вращение с ограничением 15 градусов
- Изменение яркости, контрастности и насыщенности

## Результаты
Производительность модели оценивалась с помощью метрики IoU на тестовом наборе данных. Ниже приведены результаты по эпохам:

| Эпоха | Потери на обучении | IoU на тесте |
|-------|--------------------|--------------|
| 1     | 1.5295             | 0.0332       |
| 2     | 1.3994             | 0.0332       |
| 3     | 1.1030             | 0.0332       |
| 4     | 0.9365             | 0.0337       |
| 5     | 0.7758             | 0.0358       |
| 6     | 0.8209             | 0.1072       |
| 7     | 0.9178             | 0.0801       |
| 8     | 1.0722             | 0.0660       |
| 9     | 1.0059             | 0.0645       |
| 10    | 0.8906             | 0.0651       |
| 11    | 1.0910             | 0.0691       |
| 12    | 1.0192             | 0.0734       |
| 13    | 1.2417             | 0.0750       |
| 14    | 0.9713             | 0.0815       |
| 15    | 1.0192             | 0.0901       |
| 16    | 0.9194             | 0.1088       |
| 17    | 0.9442             | 0.1386       |
| 18    | 0.7280             | 0.1767       |
| 19    | 0.8506             | 0.2017       |
| 20    | 0.7570             | 0.2230       |

### Аугментация во время тестирования (TTA)
Итоговый показатель IoU с TTA составил 0.2220.

## Вывод
Добавление аугментации данных улучшило стабильность обучения и привело к увеличению значения IoU до 0.2230 на тестовом наборе данных. Однако, улучшения были незначительными, что может указывать на необходимость дальнейшего улучшения модели или увеличения объема данных для обучения.

# Эксперимент C: Обучение UNet с предварительно обученным энкодером ResNet18

## Описание эксперимента
В этом эксперименте мы исследовали использование предварительно обученного энкодера ResNet18 в архитектуре UNet, чтобы улучшить производительность модели.

## Архитектура модели
- Энкодер: предварительно обученный ResNet18
- Декодер: модифицирован для соответствия размерам выходных данных энкодера
- Входные каналы: 3 (RGB изображения)
- Конечные выходные каналы: 1 (бинарная маска)

## Процесс обучения
- Функция потерь: Dice Loss
- Оптимизатор: Adam с learning rate 1e-4
- Размер пакета: 8
- Количество эпох: 20

## Результаты
Производительность модели оценивалась с помощью метрики IoU на тестовом наборе данных. Ниже приведены результаты по эпохам:

| Эпоха | Потери на обучении | IoU на тесте |
|-------|--------------------|--------------|
| 1     | 0.6580             | 0.2582       |
| 2     | 0.4444             | 0.1791       |
| 3     | 0.2418             | 0.1365       |
| 4     | 0.0832             | 0.1371       |
| 5     | -0.2239            | 0.1508       |
| 6     | -0.0580            | 0.1393       |
| 7     | -1.1960            | 0.1067       |
| 8     | -6.0381            | 0.0837       |
| 9     | -0.5317            | 0.1080       |
| 10    | -2.2579            | 0.1115       |
| 11    | -0.6747            | 0.1285       |
| 12    | 0.2183             | 0.1444       |
| 13    | -0.0871            | 0.1539       |
| 14    | 0.3994             | 0.1598       |
| 15    | 1.8974             | 0.1561       |
| 16    | 0.2812             | 0.1530       |
| 17    | 0.1525             | 0.1650       |
| 18    | 0.1864             | 0.1785       |
| 19    | -2.7886            | 0.1813       |
| 20    | -4.0243            | 0.1391       |

### Аугментация во время тестирования (TTA)
Итоговый показатель IoU с TTA составил 0.2656.

## Вывод
Использование предварительно обученного энкодера ResNet18 в модели UNet значительно улучшило производительность, что привело к значительному увеличению значения IoU до 0.2582 на тестовом наборе данных. Итоговый показатель IoU с TTA составил 0.2656, что является наилучшим результатом среди всех экспериментов. Это указывает на важность использования предварительно обученных моделей для улучшения качества сегментации.